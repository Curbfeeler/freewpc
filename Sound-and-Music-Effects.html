<html lang="en">
<head>
<title>Sound and Music Effects - The FreeWPC Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The FreeWPC Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Effects.html#Effects" title="Effects">
<link rel="prev" href="Lamp-Effects.html#Lamp-Effects" title="Lamp Effects">
<link rel="next" href="Lamplists.html#Lamplists" title="Lamplists">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Sound-and-Music-Effects"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Lamplists.html#Lamplists">Lamplists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Lamp-Effects.html#Lamp-Effects">Lamp Effects</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Effects.html#Effects">Effects</a>
<hr>
</div>

<h3 class="section">6.5 Sound and Music Effects</h3>

<p>The main difference with sound and music is that the main CPU does not
implement the effect; they are generated by a separate board.  The main
CPU sends commands to the secondary board to request that a particular
sound be played.  Because of this, no running task is required for the
effect.  (Platforms other than WPC may differ in this regard.)

   <p>Sounds and music may also overlap, depending on the capabilities of the
sound board.  Each platform defines a set of independent <dfn>channels</dfn>. 
When a sound needs to be played, you can specify a subset of channels that
it can be played on.  If one of them is free, the sound can be played. 
The system tracks which channels are free or in use.

   <p>There is no easy way to know when the sound has finished playing. 
The sound board is capable of sending
responses back to the CPU board, but this has not been explored
thoroughly yet.  For now, sound calls need to specify how long the
sound will take to complete, so that the channels can be deallocated. 
Exact precision is not really necessary here, unless trying to string
together a sequence of speech calls.

   <p>The <dfn>music channel</dfn> is treated special, because it is the one used
for the running background track.  All other sounds are transient, whereas
the music plays in a constant loop.

   <p>Some sound effects need to preempt the background music, so that both
are not heard simultaneously.  When a sound effect allocates the music
channel, that kills the background music first; when the temporary sound
finishes, the background is automatically restarted.

     <dl>
<dt><code>music_update</code><dd>
Request an update of the background music.

     <br><dt><code>sound_start</code><dd>
Start a sound effect.  This operates at a layer above <code>sound_send</code>,
which is the low-level API to send a command to the sound board. 
This API handles priority, channel allocation, and tracks the duration
of effects.

     <br><dt><code>sample_start</code><dd>
Start a sound sample call.

     <br><dt><code>speech_start</code><dd>
Start a speech call.

     <br><dt><code>music_effect_start</code><dd>
Start a music effect that preempts the background.

     <br><dt><code>music_disable</code><dd>
Disable the background music.

     <br><dt><code>music_enable</code><dd>
Reenable the background music.

     <br><dt><code>music_timed_disable</code><dd>
Disable the background music for a given amount of time; it will be
reenabled automatically once the time expires.

   </dl>

   </body></html>

